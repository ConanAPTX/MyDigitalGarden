---
{"number headings":"auto, first-level 4, max 6, contents
{ #toc}
, start-at 1, _.1.1","dg-publish":true,"permalink":"/15_OceanBase/05_OceanBase 性能调优/SQL 调优方法/","dgPassFrontmatter":true}
---


### 文档名称
#### 1 SQL 性能问题来源

1. 用户SQL写法 - 遵循开发规约；
2. 代价模型缺陷 - 绑定执行计划；
3. 统计信息不准确 - 仅支持本地存储，合并时更新；
4. 数据库物理设计 - 决定查询性能；
5. 系统负载 - 影响整体吞吐率，影响单sql rt；
6. 客户端路由 - 远程执行；

#### 2 SQL 调优方法
1. 针对单条 SQL 执行的性能调优
	1. 单表访问场景
		1. 索引、排序或聚合、分区、分布式并行；
	2. 多表访问场景
		1. 连接顺序、连接算法、分布式并行、查询改写；
2. 针对吞吐量的性能优化
	1. 优化慢 SQL
	2. 均衡 SQL 的请求流量资源
		1. ob_read_consistency、primary zone、客户端路由策略的设置以及业务热点查询分区的分布是否均衡等；
	3. 均衡子计划的 RPC 请求流量资源；
		1. OBServer 内部路由策略相关设置、业务热点查询的分区是否均衡


#### 3 SQL 调优基本流程

在 SQL 调优中，针对慢 SQL 的分析步骤如下：
1. 通过全局 SQL 审计表 (g)v$sql_audit、 SQL Trace 和计划缓存视图查看 SQL 执行信息，初步查找 SQL 请求的流程中导致耗时或消耗资源（如内存、磁盘 IO 等）的 SQL；
2. 单条 SQL 的执行性能往往与该 SQL 的执行计划相关，因此，执行计划的分析是最重要的手段。通过执行 EXPALIN 命令查看优化器针对给定 SQL 生成的逻辑执行计划，确定可能的调优方向；
3. 找到具体的慢 SQL，为了使某些 SQL 的执行时间或资源消耗符合预期，常见的优化方式如下：
	1. 对 SQL 做等价改写生成最佳执行计划；
	2. 针对多表访问的 SQL，还需要关注多表间的联接问题，通过优化访问路径、联接顺序和联接算法等实现查询优化；

### 参考文档



